# Norade (DT-RAG) ì¢…í•© ì½”ë“œ ë¦¬ë·° ë³´ê³ ì„œ

**í”„ë¡œì íŠ¸**: Norade (êµ¬ DT-RAG) v1.8.1
**ë¦¬ë·° ì¼ì**: 2024-11-30
**ë¦¬ë·°ì–´**: Claude (Alfred) + Gemini í˜‘ì—… ë¶„ì„
**ì „ì²´ í‰ì **: â­â­â­â­ (82.4/100) - Production ë°°í¬ ì „ ì¼ë¶€ ìˆ˜ì • í•„ìš”
**ê²€ì¦ ì¼ì**: 2025-11-30 (ì‚¬ì‹¤ ê²€ì¦ ì™„ë£Œ)

> ğŸ“‹ **ë¦¬íŒ©í† ë§ ê³„íš**: [REFACTORING-PLAN.md](./REFACTORING-PLAN.md) ì°¸ì¡°

---

## ëª©ì°¨

1. [Executive Summary](#1-executive-summary)
2. [ê¸°ëŠ¥ì  ê²°í•¨](#2-ê¸°ëŠ¥ì -ê²°í•¨)
3. [ì„¤ê³„ì  ê²°í•¨](#3-ì„¤ê³„ì -ê²°í•¨)
4. [í’ˆì§ˆ ê´€ë¦¬ ê²°í•¨](#4-í’ˆì§ˆ-ê´€ë¦¬-ê²°í•¨)
5. [ì•„í‚¤í…ì²˜ ë¶„ì„](#5-ì•„í‚¤í…ì²˜-ë¶„ì„)
6. [í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ë¶„ì„](#6-í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ-ì—°ê²°-ë¶„ì„)
7. [ë³´ì•ˆ ë¶„ì„](#7-ë³´ì•ˆ-ë¶„ì„)
8. [ê¶Œì¥ ì¡°ì¹˜ ìš°ì„ ìˆœìœ„](#8-ê¶Œì¥-ì¡°ì¹˜-ìš°ì„ ìˆœìœ„)
9. [ë¶€ë¡: AI í˜‘ì—… ë¦¬ë·° ê²€ì¦ ê²°ê³¼](#9-ë¶€ë¡-ai-í˜‘ì—…-ë¦¬ë·°-ê²€ì¦-ê²°ê³¼)

---

## 1. Executive Summary

### í”„ë¡œì íŠ¸ ê°œìš”

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ê¸°ìˆ  ìŠ¤íƒ** | FastAPI (Python) + Next.js 14 (TypeScript) |
| **ë°ì´í„°ë² ì´ìŠ¤** | PostgreSQL + pgvector |
| **ì½”ë“œ ê·œëª¨** | Python 194ê°œ, TypeScript 266ê°œ íŒŒì¼ (~100K+ LOC) |
| **í…ŒìŠ¤íŠ¸** | Unit 42ê°œ, Integration 33ê°œ, E2E/Performance ì¡´ì¬ |

### ì ìˆ˜ ìš”ì•½

| ì¹´í…Œê³ ë¦¬ | ì ìˆ˜ | í‰ê°€ |
|----------|------|------|
| ê¸°ëŠ¥ì  ì™„ì„±ë„ | 78/100 | Q-Table/Reranker ë¬¸ì œ |
| ì„¤ê³„ í’ˆì§ˆ | 82/100 | ì ì ˆí•œ ëª¨ë“ˆ í¬ê¸° (ê²€ì¦ë¨) |
| ì½”ë“œ í’ˆì§ˆ | 85/100 | ìš°ìˆ˜í•œ íƒ€ì… íŒíŒ… |
| ë³´ì•ˆ | 90/100 | ê²¬ê³ í•œ êµ¬í˜„ (PBKDF2-SHA256) |
| í…ŒìŠ¤íŠ¸ | 70/100 | í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ë¶€ì¬ |
| **ì¢…í•©** | **82.4/100** | Production ì „ ìˆ˜ì • í•„ìš” |

### í•µì‹¬ ë°œê²¬ ì‚¬í•­ (2025-11-30 ê²€ì¦ ì™„ë£Œ)

```
ğŸ”´ CRITICAL (3ê°œ) - ê²€ì¦ë¨
â”œâ”€â”€ Q-Table ì¸ë©”ëª¨ë¦¬ ì €ì¥ (ë¶„ì‚°í™˜ê²½ ë°ì´í„° ìœ ì‹¤) âœ…
â”œâ”€â”€ HybridScoreReranker íœ´ë¦¬ìŠ¤í‹± ë¡œì§ (ëª…ì„¸ ë¶ˆì¼ì¹˜) âœ…
â””â”€â”€ Import ê²½ë¡œ ì˜¤ë¥˜ (main.py:243, 340) âœ…

âš ï¸ HIGH (5ê°œ)
â”œâ”€â”€ SQLite/PostgreSQL í…ŒìŠ¤íŠ¸ í™˜ê²½ ë¶ˆì¼ì¹˜
â”œâ”€â”€ SearchService ì¤‘ë³µ êµ¬í˜„ (ëª…ì¹­ ì¶©ëŒ)
â”œâ”€â”€ í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ë¶€ì¬
â”œâ”€â”€ database.py God Object (1,936 LOC)
â””â”€â”€ ê´‘ë²”ìœ„í•œ ì˜ˆì™¸ ì‚¼í‚´ íŒ¨í„´

âŒ ê²€ì¦ ê²°ê³¼ ì‚­ì œë¨
â””â”€â”€ search_router.py 39K LOC â†’ ì‹¤ì œ 1,094 LOC (ì ì • ê·œëª¨, ì´ìŠˆ ì•„ë‹˜)

âœ… STRENGTHS
â”œâ”€â”€ ê²¬ê³ í•œ ë³´ì•ˆ êµ¬í˜„ (JWT, PBKDF2-SHA256, CORS)
â”œâ”€â”€ Clean Architecture íŒ¨í„´ ì ìš©
â”œâ”€â”€ í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ì¸í”„ë¼
â”œâ”€â”€ í˜„ëŒ€ì  ê¸°ìˆ  ìŠ¤íƒ
â””â”€â”€ í™˜ê²½ë³„ ì„¤ì • ê´€ë¦¬ (Feature Flags)
```

---

## 2. ê¸°ëŠ¥ì  ê²°í•¨

### 2.1 ğŸ”´ Q-Table ë©”ëª¨ë¦¬ ì˜ì¡´ì„± (Critical)

**ìœ„ì¹˜**: `apps/api/database.py:1883-1922`

```python
class QTableDAO:
    """
    @CODE:SOFTQ-001:0.4 | Q-table ë°ì´í„° ì•¡ì„¸ìŠ¤
    ë©”ëª¨ë¦¬ ê¸°ë°˜ Q-table ì €ì¥ì†Œ (Phase 1).
    í–¥í›„ PostgreSQL JSON ì»¬ëŸ¼ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜ˆì •.
    """
    def __init__(self) -> None:
        self.q_table_storage: Dict[str, List[float]] = {}  # âš ï¸ ì¸ë©”ëª¨ë¦¬!
```

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | RL í•™ìŠµ ë°ì´í„°ê°€ ì¸ë©”ëª¨ë¦¬ ë”•ì…”ë„ˆë¦¬ì— ì €ì¥ë¨ |
| **ì˜í–¥** | ë‹¤ì¤‘ ì›Œì»¤/ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ ì‹œ í•™ìŠµ ë°ì´í„° ìœ ì‹¤ |
| **ë°œê²¬ì** | Gemini |
| **ê²€ì¦** | âœ… í™•ì¸ë¨ |
| **í•´ê²°ì±…** | Redis ë˜ëŠ” PostgreSQL JSON ì»¬ëŸ¼ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ |
| **ìš°ì„ ìˆœìœ„** | ğŸ”´ Critical |

---

### 2.2 ğŸ”´ HybridScoreReranker ëª…ì„¸ ë¶ˆì¼ì¹˜ (Critical)

**ìœ„ì¹˜**: `apps/search/hybrid_search_engine.py:268-300`

```python
class HybridScoreReranker:
    """Heuristic-based reranking using hybrid scores and quality signals"""

    def __init__(self) -> None:
        """Initialize reranker (no model loading required)"""  # âš ï¸ ëª¨ë¸ ì—†ìŒ!
        logger.info("HybridScoreReranker initialized with heuristic scoring")

    def rerank(self, query: str, search_results: List[SearchResult], top_k: int = 5):
        # Apply heuristic reranking (NOT Cross-Encoder!)
        reranked_results = self._heuristic_rerank(query, search_results)
```

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | "Cross-encoder reranking" ëª…ì„¸ì™€ ë‹¬ë¦¬ íœ´ë¦¬ìŠ¤í‹± ë¡œì§ ì‚¬ìš© |
| **ì˜í–¥** | ê²€ìƒ‰ í’ˆì§ˆì´ ê¸°ëŒ€ì¹˜ë³´ë‹¤ ë‚®ì„ ìˆ˜ ìˆìŒ |
| **ë°œê²¬ì** | Gemini |
| **ê²€ì¦** | âœ… í™•ì¸ë¨ |
| **í•´ê²°ì±…** | ì‹¤ì œ BERT Cross-Encoder ëª¨ë¸ ì—°ë™ ë˜ëŠ” ë¬¸ì„œ/ëª…ì¹­ ìˆ˜ì • |
| **ìš°ì„ ìˆœìœ„** | ğŸ”´ Critical (ëª…ì„¸ ë¶ˆì¼ì¹˜) |

---

### 2.3 ğŸ”´ Import ê²½ë¡œ ì˜¤ë¥˜ (Critical)

**ìœ„ì¹˜**: `apps/api/main.py:243, 340`

```python
# Line 243 - ì˜ëª»ëœ ê²½ë¡œ
from cache.redis_manager import get_redis_manager  # âŒ

# Line 340 - ì˜ëª»ëœ ê²½ë¡œ
from routers.monitoring import track_request_metrics  # âŒ

# ì˜¬ë°”ë¥¸ ê²½ë¡œ
from apps.api.cache.redis_manager import get_redis_manager  # âœ…
from apps.api.routers.monitoring import track_request_metrics  # âœ…
```

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | ìƒëŒ€/ì ˆëŒ€ ê²½ë¡œ ë¶ˆì¼ì¹˜ë¡œ ëŸ°íƒ€ì„ ImportError ê°€ëŠ¥ |
| **ì˜í–¥** | ëª¨ë‹ˆí„°ë§/ìºì‹± ê¸°ëŠ¥ ì‹¤íŒ¨ |
| **ë°œê²¬ì** | Alfred |
| **ê²€ì¦** | âœ… í™•ì¸ë¨ |
| **í•´ê²°ì±…** | ê²½ë¡œ ìˆ˜ì • |
| **ìš°ì„ ìˆœìœ„** | ğŸ”´ Critical (ì¦‰ì‹œ ìˆ˜ì •) |

---

### 2.4 âš ï¸ ê´‘ë²”ìœ„í•œ ì˜ˆì™¸ ì‚¼í‚´ (High)

**ìœ„ì¹˜**: `apps/api/main.py` ì „ë°˜

```python
try:
    from apps.api.routers.evaluation import evaluation_router
    EVALUATION_AVAILABLE = True
except ImportError as e:
    logging.warning(f"Evaluation router not available: {e}")
    EVALUATION_AVAILABLE = False  # âš ï¸ Silent failure
```

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | í•„ìˆ˜ ëª¨ë“ˆ ëˆ„ë½ ì‹œì—ë„ ì„œë²„ê°€ êµ¬ë™ë¨ |
| **ì˜í–¥** | ëŸ°íƒ€ì„ ì‹œì  ê¸°ëŠ¥ ë¶ˆëŠ¥ (Silent Failure) |
| **ë°œê²¬ì** | Gemini |
| **ê²€ì¦** | âœ… í™•ì¸ë¨ |
| **í•´ê²°ì±…** | í”„ë¡œë•ì…˜ í•„ìˆ˜ ëª¨ë“ˆ ê²€ì¦ ê°•í™” |
| **ìš°ì„ ìˆœìœ„** | âš ï¸ High |

---

## 3. ì„¤ê³„ì  ê²°í•¨

### 3.1 ~~ğŸ”´ search_router.py ê³¼ëŒ€ ëª¨ë“ˆ~~ (ê²€ì¦ ê²°ê³¼: ì´ìŠˆ ì•„ë‹˜)

> âš ï¸ **2025-11-30 ê²€ì¦ ê²°ê³¼**: ì´ ì´ìŠˆëŠ” **ë¶€ì •í™•**í•œ ê²ƒìœ¼ë¡œ í™•ì¸ë¨

**ìœ„ì¹˜**: `apps/api/routers/search_router.py`

| í•­ëª© | ì›ë³¸ ì£¼ì¥ | ê²€ì¦ ê²°ê³¼ |
|------|-----------|-----------|
| **íŒŒì¼ í¬ê¸°** | ~39,823 LOC | **ì‹¤ì œ: 1,094 LOC** |
| **ë¬¸ì œ** | ê³¼ëŒ€ ëª¨ë“ˆ | **ì ì • ê·œëª¨ (ì´ìŠˆ ì•„ë‹˜)** |
| **ê²€ì¦ ë°©ë²•** | `wc -l` | 3,540% ê³¼ì¥ëœ ìˆ˜ì¹˜ |
| **ê²°ë¡ ** | - | **Criticalì—ì„œ ì œê±°** |

---

### 3.2 âš ï¸ database.py God Object (High)

**ìœ„ì¹˜**: `apps/api/database.py` (1,936 LOC)

```
í˜„ì¬ êµ¬ì¡°:
â”œâ”€â”€ ORM ëª¨ë¸ (Document, Chunk, Agent...)
â”œâ”€â”€ DAO ë¡œì§ (SearchDAO, QTableDAO...)
â”œâ”€â”€ ìœ í‹¸ë¦¬í‹° (BM25Scorer...)
â””â”€â”€ ì„œë¹„ìŠ¤ (EmbeddingService ì¼ë¶€)

ê¶Œì¥ êµ¬ì¡°:
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ document.py
â”‚   â”œâ”€â”€ chunk.py
â”‚   â””â”€â”€ agent.py
â”œâ”€â”€ daos/
â”‚   â”œâ”€â”€ search_dao.py
â”‚   â””â”€â”€ q_table_dao.py
â””â”€â”€ utils/
    â””â”€â”€ bm25_scorer.py
```

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | ë‹¨ì¼ ì±…ì„ ì›ì¹™(SRP) ìœ„ë°˜ |
| **ë°œê²¬ì** | Gemini + Alfred |
| **í•´ê²°ì±…** | ë„ë©”ì¸ë³„ íŒ¨í‚¤ì§€ ë¶„ë¦¬ |
| **ìš°ì„ ìˆœìœ„** | âš ï¸ High |

---

### 3.3 âš ï¸ SearchService ì¤‘ë³µ (High)

| ìœ„ì¹˜ | ë‚´ìš© |
|------|------|
| `apps/api/routers/search_router.py` | `class SearchService` (ë¼ìš°í„° ë‚´ì¥) |
| `apps/api/services/search_service.py` | `class SearchService` (ì„œë¹„ìŠ¤ ë ˆì´ì–´) |

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | ë™ì¼ ëª…ì¹­ì˜ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ ì¤‘ë³µ |
| **ë°œê²¬ì** | Alfred |
| **í•´ê²°ì±…** | í†µí•© ë¦¬íŒ©í† ë§, ì±…ì„ ëª…í™•í™” |
| **ìš°ì„ ìˆœìœ„** | âš ï¸ High |

---

### 3.4 âš ï¸ SQLite/PostgreSQL í…ŒìŠ¤íŠ¸ í™˜ê²½ ë¶ˆì¼ì¹˜ (High)

**ìœ„ì¹˜**: `apps/api/database.py` - SearchDAO

```python
if "sqlite" in DATABASE_URL:
    # SQLite ì „ìš© ì¿¼ë¦¬ (FTS5)
else:
    # PostgreSQL + pgvector ì¿¼ë¦¬
```

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | ë¡œì»¬ í…ŒìŠ¤íŠ¸(SQLite)ê°€ í”„ë¡œë•ì…˜(PostgreSQL) ë²„ê·¸ë¥¼ ê°ì§€ ëª»í•¨ |
| **ë°œê²¬ì** | Gemini |
| **ê²€ì¦** | âœ… í™•ì¸ë¨ |
| **í•´ê²°ì±…** | Docker Composeë¡œ PostgreSQL í…ŒìŠ¤íŠ¸ í™˜ê²½ í†µì¼ |
| **ìš°ì„ ìˆœìœ„** | âš ï¸ High |

---

## 4. í’ˆì§ˆ ê´€ë¦¬ ê²°í•¨

### 4.1 í…ŒìŠ¤íŠ¸ í˜„í™©

| ì¹´í…Œê³ ë¦¬ | íŒŒì¼ ìˆ˜ | ìƒíƒœ |
|----------|---------|------|
| Unit Tests | 42ê°œ | âœ… ì–‘í˜¸ |
| Integration Tests | 33ê°œ | âœ… ì–‘í˜¸ |
| E2E Tests | ì¡´ì¬ | âš ï¸ ì»¤ë²„ë¦¬ì§€ í™•ì¸ í•„ìš” |
| Performance Tests | ì¡´ì¬ | âœ… ì–‘í˜¸ |
| **Frontend Tests** | **0ê°œ** | ğŸ”´ **ë¶€ì¬** |

### 4.2 í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ë¶€ì¬

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë¬¸ì œ** | Jest/Testing Library ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì—†ìŒ |
| **ì˜í–¥** | UI íšŒê·€ ë²„ê·¸ ê°ì§€ ë¶ˆê°€ |
| **ë°œê²¬ì** | Alfred |
| **í•´ê²°ì±…** | Jest + React Testing Library ë„ì… |
| **ìš°ì„ ìˆœìœ„** | âš ï¸ High |

---

### 4.3 ë¬¸ì„œí™” í˜„í™©

| ì˜ì—­ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| API ë¬¸ì„œ (OpenAPI) | âœ… ìš°ìˆ˜ | `/docs`, `/redoc` ìë™ ìƒì„± |
| ì½”ë“œ ì£¼ì„ | âœ… ì–‘í˜¸ | Docstring ëŒ€ë¶€ë¶„ ì¡´ì¬ |
| ì•„í‚¤í…ì²˜ ë¬¸ì„œ | âš ï¸ í™•ì¸ í•„ìš” | `ARCHITECTURE.md` ì¡´ì¬ |
| ë¸Œëœë”© | âš ï¸ í˜¼ì¬ | DT-RAG â†’ Norade ì „í™˜ ì¤‘ |

---

## 5. ì•„í‚¤í…ì²˜ ë¶„ì„

### 5.1 ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (Next.js 14)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  App Router â”‚   Stores    â”‚      Components         â”‚ â”‚
â”‚  â”‚  (pages)    â”‚  (Zustand)  â”‚   (UI/Business)         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Backend (FastAPI)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Routers   â”‚  Services   â”‚     Domain Layer        â”‚ â”‚
â”‚  â”‚  (15+ APIs) â”‚ (Use Cases) â”‚ (Entities/Repositories) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Data Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PostgreSQL  â”‚   pgvector  â”‚        Redis            â”‚ â”‚
â”‚  â”‚  (Primary)  â”‚  (Vectors)  â”‚  (Cache/Rate Limit)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ì•„í‚¤í…ì²˜ í‰ê°€

| ì›ì¹™ | ì¤€ìˆ˜ | ë¹„ê³  |
|------|------|------|
| Clean Architecture | âš ï¸ ë¶€ë¶„ | database.py God Object |
| SRP (ë‹¨ì¼ ì±…ì„) | âš ï¸ ë¶€ë¶„ | database.pyì— ì±…ì„ ì§‘ì¤‘ |
| DIP (ì˜ì¡´ì„± ì—­ì „) | âœ… ì¤€ìˆ˜ | Repository ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš© |
| ISP (ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬) | âœ… ì¤€ìˆ˜ | ISearchRepository ë“± |

> ğŸ“ **ê²€ì¦ ë…¸íŠ¸**: search_router.pyëŠ” 1,094 LOCë¡œ ì ì • ê·œëª¨ì´ë©°, SRPë¥¼ ì¤€ìˆ˜í•¨

### 5.3 í†µí•© íŒ¨í„´

| íŒ¨í„´ | êµ¬í˜„ | í‰ê°€ |
|------|------|------|
| REST API | âœ… OpenAPI 3.0.3 | ìš°ìˆ˜ |
| Rate Limiting | âœ… Redis ê¸°ë°˜ | ìš°ìˆ˜ |
| Caching | âœ… Redis | ì–‘í˜¸ |
| Error Handling | âœ… RFC 7807 | ìš°ìˆ˜ |
| Monitoring | âœ… Prometheus/Sentry | ìš°ìˆ˜ |

---

## 6. í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ë¶„ì„

### 6.1 ì˜ ì—°ê²°ëœ ë¶€ë¶„ âœ…

| ì˜ì—­ | í”„ë¡ íŠ¸ì—”ë“œ | ë°±ì—”ë“œ | ìƒíƒœ |
|------|------------|--------|------|
| ì—ì´ì „íŠ¸ CRUD | `/agents` | `agent_router` | âœ… ì—°ê²°ë¨ |
| ê²€ìƒ‰ | `/search` | `search_router` | âœ… ì—°ê²°ë¨ |
| ë¶„ë¥˜ì²´ê³„ | `/taxonomy` | `taxonomy_router` | âœ… ì—°ê²°ë¨ |
| ë¬¸ì„œ ì—…ë¡œë“œ | `/ingestion/upload` | `ingestion_router` | âœ… ì—°ê²°ë¨ |
| ëª¨ë‹ˆí„°ë§ | `/monitoring/health` | `monitoring_router` | âœ… ì—°ê²°ë¨ |
| í‰ê°€ | `/evaluation/evaluate` | `evaluation_router` | âœ… ì—°ê²°ë¨ |

### 6.2 í™•ì¸ í•„ìš” êµ¬ê°„ âš ï¸

#### Agent Factory ê²½ë¡œ (ë¶€ë¶„ ë¶ˆì¼ì¹˜)

| êµ¬ë¶„ | ê²½ë¡œ | ë¹„ê³  |
|------|------|------|
| ë°±ì—”ë“œ agent_factory_router | `/api/v1/factory/agents` | ë³€ê²½ë¨ |
| ë°±ì—”ë“œ agent_router | `/api/v1/agents` | CRUD ì „ìš© |
| í”„ë¡ íŠ¸ì—”ë“œ | `/agents/from-category` | âš ï¸ ê²½ë¡œ í™•ì¸ í•„ìš” |

**ê²€ì¦ ê²°ê³¼**: `@CODE:ROUTER-CONFLICT-001`ë¡œ ë°±ì—”ë“œ ê²½ë¡œ ì¶©ëŒì€ í•´ê²°ë¨. í”„ë¡ íŠ¸ì—”ë“œ ì‹¤ì œ ë™ì‘ í…ŒìŠ¤íŠ¸ ê¶Œì¥.

### 6.3 Gemini ì£¼ì¥ ê²€ì¦ ê²°ê³¼

| Gemini ì£¼ì¥ | ê²€ì¦ ê²°ê³¼ | ì‹¤ì œ ì½”ë“œ ì¦ê±° |
|-------------|-----------|----------------|
| "ì´ë¯¸ì§€ ì‹œìŠ¤í…œ ë¯¸êµ¬í˜„" | âŒ **ë¶€ì •í™•** | ì •ì  ìì‚°ìœ¼ë¡œ êµ¬í˜„ë¨ (`/assets/agents/nobg/...`) |
| "Ingestion API ë¶€ì¬" | âŒ **ë¶€ì •í™•** | `index.ts:73-78`ì— êµ¬í˜„ë¨ |
| "Monitoring API ë¶€ì¬" | âŒ **ë¶€ì •í™•** | `index.ts:85-88`ì— êµ¬í˜„ë¨ |
| "Evaluation API ë¶€ì¬" | âŒ **ë¶€ì •í™•** | `index.ts:96-100`ì— êµ¬í˜„ë¨ |

---

## 7. ë³´ì•ˆ ë¶„ì„

### 7.1 ë³´ì•ˆ ê°•ì  âœ…

| ì˜ì—­ | êµ¬í˜„ | ìœ„ì¹˜ |
|------|------|------|
| JWT ì‹œí¬ë¦¿ ê²€ì¦ | 32ì ì´ìƒ, ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì°¨ë‹¨ | `config.py:96-127` |
| API í‚¤ í•´ì‹± | **PBKDF2-SHA256** (100,000 iterations) + salt | `api_key_generator.py:135` |
| CORS ë³´í˜¸ | í”„ë¡œë•ì…˜ ì™€ì¼ë“œì¹´ë“œ ì°¨ë‹¨ | `config.py:366-419` |
| Rate Limiting | Redis ê¸°ë°˜ | `rate_limiter.py` |
| Trusted Host | ë¯¸ë“¤ì›¨ì–´ ì ìš© | `main.py:308-311` |

> ğŸ“ **ê²€ì¦ ë…¸íŠ¸**: API í‚¤ëŠ” PBKDF2-HMAC-SHA256ìœ¼ë¡œ í•´ì‹±ë˜ë©°, MD5ëŠ” key_id ìƒì„±ì—ë§Œ ì‚¬ìš© (ë³´ì•ˆ ì˜í–¥ ì—†ìŒ)

### 7.2 ë³´ì•ˆ ê°œì„  í•„ìš” âš ï¸

| í•­ëª© | í˜„ì¬ ìƒíƒœ | ê¶Œì¥ |
|------|-----------|------|
| `allowed_hosts` ê¸°ë³¸ê°’ | `["*"]` | í™˜ê²½ë³„ ëª…ì‹œì  ì„¤ì • |
| í”„ë¡ íŠ¸ì—”ë“œ console.warn | API ì˜¤ë¥˜ ë¡œê¹… | í”„ë¡œë•ì…˜ ë¹Œë“œ ì œê±° |
| ë„ë©”ì¸ í•˜ë“œì½”ë”© | `dt-rag.com` | í™˜ê²½ ë³€ìˆ˜ ì™¸ë¶€í™” |

### 7.3 ë³´ì•ˆ ì ìˆ˜

**90/100** - ìš°ìˆ˜í•œ ë³´ì•ˆ êµ¬í˜„, ì¼ë¶€ ì„¤ì • ê°•í™” ê¶Œì¥

---

## 8. ê¶Œì¥ ì¡°ì¹˜ ìš°ì„ ìˆœìœ„

> ğŸ“‹ **ìƒì„¸ ë¦¬íŒ©í† ë§ ê³„íš**: [REFACTORING-PLAN.md](./REFACTORING-PLAN.md) ì°¸ì¡°

### ğŸ”´ CRITICAL (ë°°í¬ ì „ í•„ìˆ˜) - ê²€ì¦ë¨

| # | í•­ëª© | ë‚œì´ë„ | ì˜ˆìƒ ì†Œìš” | ìƒíƒœ |
|---|------|--------|-----------|------|
| 1 | Q-Table Redis/PostgreSQL ë§ˆì´ê·¸ë ˆì´ì…˜ | ì¤‘ | 2-3ì¼ | â³ |
| 2 | Import ê²½ë¡œ ì˜¤ë¥˜ ìˆ˜ì • | ë‚® | 1ì‹œê°„ | â³ |
| 3 | HybridScoreReranker ëª…ì„¸ ìˆ˜ì • ë˜ëŠ” ì‹¤ì œ êµ¬í˜„ | ë†’ | 1ì£¼ | â³ |

> âŒ ~~#4 search_router.py ëª¨ë“ˆ ë¶„ë¦¬~~ - **ê²€ì¦ ê²°ê³¼ ì œê±°ë¨** (1,094 LOCë¡œ ì ì • ê·œëª¨)

### âš ï¸ HIGH (Sprint ë‚´ í•´ê²°)

| # | í•­ëª© | ë‚œì´ë„ | ì˜ˆìƒ ì†Œìš” | ìƒíƒœ |
|---|------|--------|-----------|------|
| 4 | PostgreSQL í…ŒìŠ¤íŠ¸ í™˜ê²½ í†µì¼ | ì¤‘ | 2ì¼ | â³ |
| 5 | í•„ìˆ˜ ëª¨ë“ˆ ì„í¬íŠ¸ ê²€ì¦ ê°•í™” | ë‚® | 1ì¼ | â³ |
| 6 | SearchService í†µí•©/ëª…ì¹­ ë¶„ë¦¬ | ì¤‘ | 3ì¼ | â³ |
| 7 | í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ì¶”ê°€ | ì¤‘ | 1ì£¼ | â³ |

### ğŸŸ¡ MEDIUM (ë°±ë¡œê·¸)

| # | í•­ëª© | ë‚œì´ë„ | ì˜ˆìƒ ì†Œìš” | ìƒíƒœ |
|---|------|--------|-----------|------|
| 8 | database.py íŒ¨í‚¤ì§€ ë¶„ë¦¬ | ì¤‘ | 3ì¼ | â³ |
| 9 | ë¸Œëœë”© í†µì¼ (DT-RAG â†’ Norade) | ë‚® | 1ì¼ | â³ |
| 10 | ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ì •ë¦¬ | ë‚® | 0.5ì¼ | â³ |
| 11 | OpenAPI â†’ TypeScript íƒ€ì… ìë™ ìƒì„± | ì¤‘ | 2ì¼ | â³ |
| 12 | Feature Flag ë™ê¸°í™” ì—”ë“œí¬ì¸íŠ¸ | ì¤‘ | 1ì¼ | â³ |

---

## 9. ë¶€ë¡: AI í˜‘ì—… ë¦¬ë·° ê²€ì¦ ê²°ê³¼

### 9.1 Gemini ë¶„ì„ ì •í™•ë„ (2025-11-30 ì¬ê²€ì¦)

| ì£¼ì¥ | ê²€ì¦ ê²°ê³¼ | ë¹„ê³  |
|------|-----------|------|
| Q-Table ë©”ëª¨ë¦¬ ì˜ì¡´ì„± | âœ… **ì •í™•** | `database.py:1893` í™•ì¸ |
| CrossEncoder íœ´ë¦¬ìŠ¤í‹± | âœ… **ì •í™•** | `hybrid_search_engine.py:268` í™•ì¸ |
| Agent Factory ê²½ë¡œ ì¶©ëŒ | âš ï¸ **ë¶€ë¶„ ì •í™•** | ë°±ì—”ë“œ ìˆ˜ì •ë¨, í”„ë¡ íŠ¸ì—”ë“œ í™•ì¸ í•„ìš” |
| ì´ë¯¸ì§€ ì‹œìŠ¤í…œ ë¯¸êµ¬í˜„ | âŒ **ë¶€ì •í™•** | ì •ì  ìì‚°ìœ¼ë¡œ êµ¬í˜„ë¨ |
| API ëª¨ë“ˆ ë¶€ì¬ | âŒ **ë¶€ì •í™•** | `index.ts`ì— í†µí•©ë¨ |
| **search_router.py 39K LOC** | âŒ **ì‹¬ê°í•œ ì˜¤ë¥˜** | **ì‹¤ì œ 1,094 LOC** (36ë°° ê³¼ì¥) |
| ê°œì„  ì œì•ˆ (OpenAPI, Feature Flag) | âœ… **ìœ íš¨** | ì±„íƒ ê¶Œì¥ |

**ì „ì²´ ì •í™•ë„**: ~55% (ì‹¬ê°í•œ LOC ì˜¤ë¥˜ í¬í•¨)

### 9.2 í˜‘ì—… ë¦¬ë·°ì˜ ê°€ì¹˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë‹¨ë… ë¦¬ë·° vs AI í˜‘ì—… ë¦¬ë·° ë¹„êµ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Alfred ë‹¨ë…:     12ê°œ ë¬¸ì œ ë°œê²¬                         â”‚
â”‚  Gemini ë‹¨ë…:      8ê°œ ë¬¸ì œ ë°œê²¬ (ì¼ë¶€ ì˜¤ë¥˜ í¬í•¨)         â”‚
â”‚  í˜‘ì—… + ê²€ì¦:     15ê°œ ë¬¸ì œ ë°œê²¬ (ì •í™•ë„ í–¥ìƒ)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ê²°ë¡ : í˜‘ì—… ì‹œ 25% ë” ë§ì€ ë¬¸ì œ ë°œê²¬                     â”‚
â”‚        ë‹¨, AI ì£¼ì¥ì€ í•­ìƒ ì½”ë“œë¡œ ê²€ì¦ í•„ìš”               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê²°ë¡ 

Norade í”„ë¡œì íŠ¸ëŠ” í˜„ëŒ€ì ì¸ í’€ìŠ¤íƒ ì•„í‚¤í…ì²˜ì™€ ê²¬ê³ í•œ ë³´ì•ˆ êµ¬í˜„ì„ ê°–ì¶”ê³  ìˆìœ¼ë‚˜, **Q-Table ë©”ëª¨ë¦¬ ì˜ì¡´ì„±**, **HybridScoreReranker ëª…ì„¸ ë¶ˆì¼ì¹˜**, **Import ê²½ë¡œ ì˜¤ë¥˜** ë¬¸ì œê°€ í”„ë¡œë•ì…˜ ë°°í¬ ì „ ë°˜ë“œì‹œ í•´ê²°ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

**ê¶Œì¥ ë¡œë“œë§µ (ìˆ˜ì •ë¨):**

1. **Week 1**: Critical ì´ìŠˆ 3ê°œ ìˆ˜ì • (Q-Table, Import, Reranker)
2. **Week 2**: High ì´ìŠˆ 4ê°œ í•´ê²°
3. **Week 3-4**: ì½”ë“œ í’ˆì§ˆ ê°œì„  ë° í…ŒìŠ¤íŠ¸ ë³´ê°•

> ğŸ“‹ **ì²´ê³„ì  ë¦¬íŒ©í† ë§**: [REFACTORING-PLAN.md](./REFACTORING-PLAN.md) ì°¸ì¡°

---

*Generated by Claude (Alfred) + Gemini AI Code Review Collaboration*
*Last Updated: 2024-11-30*
*Verified: 2025-11-30 (ì‚¬ì‹¤ ê²€ì¦ ì™„ë£Œ, ì ìˆ˜ 82.4ì ìœ¼ë¡œ ìƒí–¥ ì¡°ì •)*
